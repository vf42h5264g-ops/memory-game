/* =====================
   Base
===================== */
* { box-sizing: border-box; }
body {
  margin: 0;
  color: #f5f1e8;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #000;
}

/* =====================
   Screen
===================== */
.screen {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 14px;
  padding: 24px 16px;
}

.hidden { display: none !important; }

/* =====================
   Start Screen (BAR)
===================== */
#startScreen{
  position: relative;
  overflow: hidden;
  background: radial-gradient(circle at top, #3a0f14 0%, #1b070a 40%, #000 100%);
}

#startScreen h1 {
  margin: 0;
  font-size: 38px;
  letter-spacing: 0.06em;
  font-weight: 800;
  text-align: center;
}

.subtitle {
  margin-top: -6px;
  font-size: 14px;
  letter-spacing: 0.28em;
  opacity: 0.9;
}

/* モードボタン */
.modeBtns {
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: min(360px, 86vw);
  margin-top: 10px;
}

.modeBtn {
  user-select: none;
  cursor: pointer;
  padding: 16px 18px;
  border-radius: 16px;
  background: #e53935;
  color: #fff;
  text-align: center;
  font-weight: 900;
  letter-spacing: 0.08em;
  box-shadow: 0 10px 22px rgba(0,0,0,0.35);
}

.modeBtn:active {
  transform: scale(0.98);
  filter: brightness(0.95);
}

/* NT-Dボタンは少しだけ怪しく */
.modeBtn[data-mode="destroy"]{
  border: 1px solid rgba(255,255,255,0.10);
}

/* 下のテキスト */
.footerText{
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: 86px;
  font-size: 12px;
  letter-spacing: 0.08em;
  opacity: 0.7;
}

/* =====================
   Start Screen Icons
===================== */
#shotBtn, #helpBtn, #soundBtn{
  width: 52px;
  height: 52px;
  display: grid;
  place-items: center;
  font-size: 26px;
  border-radius: 999px;
  background: rgba(255,255,255,0.10);
  border: 1px solid rgba(255,255,255,0.12);
  cursor: pointer;
  user-select: none;
  box-shadow: 0 10px 24px rgba(0,0,0,0.35);
  touch-action: manipulation;
}


/* 押し込み */
#shotBtn:active, #soundBtn:active{
  transform: scale(0.96);
}
#helpBtn:active{
  transform: translateX(-50%) scale(0.96);
}

/* =====================
   Neon / Flicker (NT-D)
===================== */
#startScreen.neon{
  background:
    radial-gradient(circle at 20% 20%, rgba(255, 60, 60, 0.18) 0%, rgba(0,0,0,0) 45%),
    radial-gradient(circle at 80% 30%, rgba(255, 0, 120, 0.10) 0%, rgba(0,0,0,0) 50%),
    radial-gradient(circle at top, #4a1016 0%, #1b070a 40%, #000 100%);
}

/* 霞レイヤー */
#startScreen.neon::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    linear-gradient(180deg, rgba(255,0,80,0.10), rgba(0,0,0,0) 60%),
    radial-gradient(circle at 50% 15%, rgba(255,60,60,0.22), rgba(0,0,0,0) 55%);
  mix-blend-mode: screen;
}

/* タイトル発光 */
#startScreen.neon h1,
#startScreen.neon .subtitle{
  text-shadow:
    0 0 10px rgba(255, 40, 40, 0.25),
    0 0 22px rgba(255, 0, 120, 0.18);
}

/* フリッカー */
@keyframes neonFlicker{
  0%,100%{ filter: brightness(1); }
  10%{ filter: brightness(1.15); }
  12%{ filter: brightness(0.9); }
  15%{ filter: brightness(1.25); }
  18%{ filter: brightness(0.85); }
  22%{ filter: brightness(1.2); }
  40%{ filter: brightness(1.05); }
  42%{ filter: brightness(0.92); }
  45%{ filter: brightness(1.18); }
}
#startScreen.neon{
  animation: neonFlicker 1.25s infinite;
}

/* NT-Dボタンも強化 */
#startScreen.neon .modeBtn[data-mode="destroy"]{
  box-shadow:
    0 0 14px rgba(255, 0, 0, 0.35),
    0 0 30px rgba(255, 0, 120, 0.22),
    0 10px 22px rgba(0,0,0,0.55);
}

/* =====================
   Game Screen
===================== */
#gameScreen{
  background: radial-gradient(circle at top, #120507 0%, #000 65%);
}

#countdown{
  font-size: 56px;
  font-weight: 900;
  letter-spacing: 0.08em;
  margin-bottom: 8px;
}

#missArea{
  min-height: 26px;
  margin-bottom: 10px;
  opacity: 0.9;
}

/* Board layouts */
#board{
  display: grid;
  gap: 10px;
  width: min(440px, 92vw);
  justify-content: center;
}

/* easy(6枚) 3x2 */
#board.layout-easy{
  grid-template-columns: repeat(3, 1fr);
}

/* normal/hard/NT-D(12枚) 4x3 */
#board.layout-12{
  grid-template-columns: repeat(4, 1fr);
}

.card{
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.10);
}

.card img{
  width: 100%;
  aspect-ratio: 1 / 1;
  display: block;
  object-fit: cover;
}

/* =====================
   Result / Help
===================== */
#helpScreen, #resultScreen{
  background: radial-gradient(circle at top, #120507 0%, #000 65%);
}

button{
  padding: 12px 18px;
  font-size: 16px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
}

button:active{
  transform: scale(0.98);
}

/* 初期状態（NT-D文字は白） */
.modeBtn[data-mode="destroy"]{
  color: #fff;
  transition: color 3s linear, text-shadow 3s linear;
}

/* 3秒で蛍光ピンクへ（transitionで変化） */
.modeBtn[data-mode="destroy"].charging{
  color: #ff3bd4 !important;
  text-shadow: 0 0 18px rgba(255, 60, 212, 0.55);
}

/* NT-D押下：3秒かけて文字が蛍光ピンクへ */
@keyframes ntdCharge {
  0%   { color: #ffffff; text-shadow: none; }
  60%  { color: #ffd1f0; text-shadow: 0 0 10px rgba(255, 60, 180, 0.25); }
  100% { color: #ff3bd4; text-shadow: 0 0 18px rgba(255, 60, 212, 0.55); }
}

/* 1秒チカチカ用 */
@keyframes neonFlickerFast{
  0%,100%{ filter: brightness(1); }
  10%{ filter: brightness(1.18); }
  12%{ filter: brightness(0.85); }
  16%{ filter: brightness(1.28); }
  20%{ filter: brightness(0.80); }
  26%{ filter: brightness(1.22); }
  40%{ filter: brightness(1.10); }
  45%{ filter: brightness(0.92); }
  55%{ filter: brightness(1.20); }
}

/* NT-Dボタン本体 */
.modeBtn[data-mode="destroy"]{
  position: relative;
}

/* “充電中”のとき：文字だけをアニメーション */
.modeBtn[data-mode="destroy"].charging{
  animation: ntdCharge 3s forwards;
}

/* “フリッカー中”のとき：背景も含めて1秒だけチカチカ */
#startScreen.flicker{
  animation: neonFlickerFast 1s linear infinite;
}

.modeBtn[data-mode="destroy"].charging{
  animation: ntdCharge 3s forwards;
  color: #ff3bd4 !important; /* 最終色の保険 */
}

#startScreen { position: relative; }

/* =========================
   フッターボタン（下段）
========================= */

.footerBtns {
  position: fixed;
  bottom: 18px;
  left: 50%;
  transform: translateX(-50%);
  width: min(92vw, 420px);

  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 10px 14px;
  border-radius: 22px;

  background: rgba(0, 0, 0, 0.45);
  backdrop-filter: blur(6px);
  z-index: 20;
}

.footerBtns button {
  width: 56px;
  height: 56px;
  border-radius: 50%;

  font-size: 26px;
  border: none;
  cursor: pointer;

  background: rgba(255, 255, 255, 0.08);
  color: #fff;

  display: flex;
  align-items: center;
  justify-content: center;

  transition: transform 0.12s ease, background 0.12s ease;
}

.footerBtns button:active {
  transform: scale(0.92);
  background: rgba(255, 255, 255, 0.18);
}

/* 投げ銭ボタンだけ少し特別感 */
#donateBtn {
  background: rgba(255, 215, 100, 0.18);
}

/* 下段ボタン：フッターバーで統一 */
.footerBtns{
  position: fixed;
  left: 0;
  right: 0;
  bottom: calc(14px + env(safe-area-inset-bottom)); /* iPhone対策 */
  display: flex;
  justify-content: space-evenly; /* 均等配置 */
  align-items: center;
  gap: 14px;
  padding: 0 14px;
  z-index: 50;
}

/* 重要：個別absolute配置を無効化して、横並びに従わせる */
#shotBtn, #helpBtn, #donateBtn, #soundBtn{
  position: static !important;
  transform: none !important;
}

/* 下のテキストがボタンの上に被らないように */
.footerText{
  position: fixed; /* absolute でも可だが、fixedが安定 */
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(14px + 52px + 18px + env(safe-area-inset-bottom));
  z-index: 10;
  pointer-events: none; /* ボタン操作を邪魔しない */
}
